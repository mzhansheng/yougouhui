define(["jquery","backbone","models/CommonViewModel","views/ViewFactory"],function(k,i,j,l){var g=new Array();var h=i.Router.extend({initialize:function(){},identy:function(c){var a=null;for(var d=0;d<g.length;d++){var b=g[d];if(b.code==c){a=b.view;break}}if(!a){k.mobile.changePage("#"+c,{reverse:false,changeHash:false});return}k.mobile.loading("show");a.collection.fetch({success:function(e,n,f){e.trigger("added")},error:function(){k.mobile.loading("hide");alert("加载数据失败.")}}).done(function(){k.mobile.loading("hide");k.mobile.changePage("#"+c,{reverse:false,changeHash:false})})},addViews:function(a,b){k.each(a,function(d,r){var s=false;var q=r.code;if(b){for(var c=0;c<b.length;c++){if(q==b[c]){s=true;break}}}if(!s){var e=new j({el_data:"#"+q,collection_data:{models:[],options:{title:r.name}}});var f=l.getView(q,e);if(f){g.push({code:q,view:f})}}})}});return h});